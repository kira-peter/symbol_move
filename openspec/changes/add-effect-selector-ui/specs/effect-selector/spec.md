# Effect Selector UI Specification

## ADDED Requirements

### Requirement: 特效选择器基础界面
系统 SHALL 提供一个交互式的特效选择器主界面，允许用户浏览和选择可用的特效。

#### Scenario: 启动显示主界面
- **WHEN** 用户启动程序
- **THEN** 显示特效选择器主界面
- **AND** 界面包含项目标题"符动世界 (SymbolMove)"
- **AND** 显示所有可用特效的列表
- **AND** 第一个特效默认被选中高亮

#### Scenario: 特效列表显示
- **WHEN** 主界面渲染时
- **THEN** 每个特效显示为一行
- **AND** 显示特效名称
- **AND** 当前选中的特效高亮显示（不同颜色或背景）
- **AND** 未选中的特效使用普通样式

#### Scenario: 特效描述预览
- **WHEN** 用户选中某个特效时
- **THEN** 界面底部或侧边显示该特效的描述信息
- **AND** 描述包含特效的简介
- **AND** 可选包含特效的特性说明

### Requirement: 键盘导航
系统 SHALL 支持通过键盘进行特效选择和导航。

#### Scenario: 向下导航
- **WHEN** 用户按下向下箭头键或 j 键
- **THEN** 选中状态移动到下一个特效
- **AND** 高亮随之移动
- **AND** 特效描述更新为新选中的特效

#### Scenario: 向上导航
- **WHEN** 用户按下向上箭头键或 k 键
- **THEN** 选中状态移动到上一个特效
- **AND** 高亮随之移动
- **AND** 特效描述更新为新选中的特效

#### Scenario: 循环导航
- **WHEN** 在第一个特效时按向上键
- **THEN** 选中状态跳转到最后一个特效
- **WHEN** 在最后一个特效时按向下键
- **THEN** 选中状态跳转到第一个特效

#### Scenario: 数字快捷键选择
- **WHEN** 用户按下数字键（1-9）
- **THEN** 直接选中对应序号的特效（如果存在）
- **AND** 高亮移动到该特效

### Requirement: 特效启动和退出
系统 SHALL 支持启动选中的特效并能够返回主界面。

#### Scenario: 确认启动特效
- **WHEN** 用户在选中特效时按下回车键
- **THEN** 主界面关闭
- **AND** 选中的特效立即启动并全屏运行
- **AND** 终端被特效完全控制

#### Scenario: 从特效返回主界面
- **WHEN** 用户在特效运行时按下 ESC 键
- **THEN** 特效停止运行
- **AND** 特效资源被清理释放
- **AND** 返回到特效选择器主界面
- **AND** 之前选中的特效保持选中状态

#### Scenario: 直接退出程序
- **WHEN** 用户在主界面按下 q 键或 Ctrl+C
- **THEN** 程序优雅退出
- **AND** 终端恢复原始状态

### Requirement: 特效注册和管理
系统 SHALL 提供特效注册机制，使得添加新特效无需修改主界面代码。

#### Scenario: 特效注册
- **WHEN** 程序初始化时
- **THEN** 所有特效通过注册表自动注册
- **AND** 每个特效提供名称、描述和元数据
- **AND** 特效按注册顺序或指定顺序排列

#### Scenario: 特效接口规范
- **WHEN** 实现新特效时
- **THEN** 特效实现标准的 Effect 接口
- **AND** 提供 Init() 初始化方法
- **AND** 提供 Run() 运行方法
- **AND** 提供 Cleanup() 清理方法
- **AND** 提供 Metadata() 元数据方法

#### Scenario: 动态特效列表
- **WHEN** 添加或移除特效时
- **THEN** 主界面自动反映变化
- **AND** 无需修改主界面代码
- **AND** 新特效自动出现在列表中

### Requirement: 界面布局和美观
系统 SHALL 提供清晰、美观的界面布局。

#### Scenario: 标题区域
- **WHEN** 主界面渲染时
- **THEN** 顶部显示项目标题"符动世界"
- **AND** 标题使用醒目的样式（如 ASCII 艺术字或大字体）
- **AND** 副标题显示"字符符号在动，创造世界"

#### Scenario: 列表区域
- **WHEN** 显示特效列表时
- **THEN** 列表居中或左对齐显示
- **AND** 每个特效前显示序号
- **AND** 选中项使用高亮颜色（如亮绿色或反色）
- **AND** 列表项之间有适当间距

#### Scenario: 提示区域
- **WHEN** 主界面渲染时
- **THEN** 底部显示操作提示
- **AND** 提示包含"↑↓: 选择 | Enter: 确认 | q: 退出"
- **AND** 提示使用低调的颜色（如灰色）

#### Scenario: 描述区域
- **WHEN** 选中特效时
- **THEN** 在适当位置显示特效描述
- **AND** 描述使用边框或分隔线隔开
- **AND** 描述文字清晰易读

### Requirement: 终端适配
系统 SHALL 自动适配不同的终端环境和尺寸。

#### Scenario: 终端尺寸检测
- **WHEN** 程序启动或终端大小改变时
- **THEN** 自动检测终端宽度和高度
- **AND** 根据尺寸调整界面布局
- **AND** 确保内容在可视范围内

#### Scenario: 小终端处理
- **WHEN** 终端尺寸过小时
- **THEN** 显示警告或简化界面
- **AND** 确保核心功能仍可用
- **OR** 提示用户调整终端大小

#### Scenario: 大终端优化
- **WHEN** 终端尺寸很大时
- **THEN** 内容居中显示
- **AND** 使用更大的间距和边距
- **AND** 保持视觉平衡

### Requirement: 错误处理和健壮性
系统 SHALL 优雅处理各种错误情况。

#### Scenario: 特效启动失败
- **WHEN** 特效启动时发生错误
- **THEN** 显示错误信息
- **AND** 返回主界面
- **AND** 用户可以选择其他特效

#### Scenario: 终端初始化失败
- **WHEN** 无法初始化终端时
- **THEN** 在标准输出显示错误信息
- **AND** 提供故障排查建议
- **AND** 程序优雅退出

#### Scenario: 资源清理
- **WHEN** 程序退出或特效切换时
- **THEN** 所有分配的资源被释放
- **AND** 终端状态被恢复
- **AND** 无内存泄漏或资源残留

### Requirement: 性能和响应性
系统 SHALL 提供流畅的用户体验。

#### Scenario: 快速响应
- **WHEN** 用户按下按键时
- **THEN** 界面立即响应（延迟 < 100ms）
- **AND** 高亮移动平滑无卡顿
- **AND** 特效启动快速（< 1s）

#### Scenario: 低资源占用
- **WHEN** 主界面运行时
- **THEN** CPU 占用率保持低位（< 5%）
- **AND** 内存占用合理（< 10MB）
- **AND** 不影响特效性能

#### Scenario: 特效隔离
- **WHEN** 从一个特效切换到另一个时
- **THEN** 前一个特效的状态完全清除
- **AND** 新特效从全新状态启动
- **AND** 无状态残留或干扰
